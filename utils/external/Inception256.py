import tensorflow as tf

is_train = False




def KitModel(input, is_train,num_classes):

    conv1_7x7_s2_pad = tf.pad(input, paddings = [[0, 0], [3, 3], [3, 3], [0, 0]])
    conv1_7x7_s2    = convolution(conv1_7x7_s2_pad, group=1, strides=[2, 2], padding='VALID', name='conv1/7x7_s2')
    conv1_relu_7x7  = tf.nn.relu(conv1_7x7_s2, name = 'conv1/relu_7x7')
    pool1_3x3_s2_pad = tf.pad(conv1_relu_7x7, paddings = [[0, 0], [0, 1], [0, 1], [0, 0]], constant_values=float('-Inf'))
    pool1_3x3_s2    = tf.nn.max_pool(pool1_3x3_s2_pad, [1, 3, 3, 1], [1, 2, 2, 1], padding='VALID', name='pool1/3x3_s2')
    conv2_3x3_reduce = convolution(pool1_3x3_s2, group=1, strides=[1, 1], padding='VALID', name='conv2/3x3_reduce')
    conv2_relu_3x3_reduce = tf.nn.relu(conv2_3x3_reduce, name = 'conv2/relu_3x3_reduce')
    conv2_3x3_pad   = tf.pad(conv2_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    conv2_3x3       = convolution(conv2_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='conv2/3x3')
    conv2_relu_3x3  = tf.nn.relu(conv2_3x3, name = 'conv2/relu_3x3')
    pool2_3x3_s2_pad = tf.pad(conv2_relu_3x3, paddings = [[0, 0], [0, 1], [0, 1], [0, 0]], constant_values=float('-Inf'))
    pool2_3x3_s2    = tf.nn.max_pool(pool2_3x3_s2_pad, [1, 3, 3, 1], [1, 2, 2, 1], padding='VALID', name='pool2/3x3_s2')
    inception_3a_1x1 = convolution(pool2_3x3_s2, group=1, strides=[1, 1], padding='VALID', name='inception_3a/1x1')
    inception_3a_pool = tf.nn.avg_pool(pool2_3x3_s2, [1, 3, 3, 1], [1, 1, 1, 1], padding='SAME', name='inception_3a/pool')
    inception_3a_double_3x3_reduce = convolution(pool2_3x3_s2, group=1, strides=[1, 1], padding='VALID', name='inception_3a/double_3x3_reduce')
    inception_3a_3x3_reduce = convolution(pool2_3x3_s2, group=1, strides=[1, 1], padding='VALID', name='inception_3a/3x3_reduce')
    inception_3a_relu_1x1 = tf.nn.relu(inception_3a_1x1, name = 'inception_3a/relu_1x1')
    inception_3a_pool_proj = convolution(inception_3a_pool, group=1, strides=[1, 1], padding='VALID', name='inception_3a/pool_proj')
    inception_3a_relu_double_3x3_reduce = tf.nn.relu(inception_3a_double_3x3_reduce, name = 'inception_3a/relu_double_3x3_reduce')
    inception_3a_relu_3x3_reduce = tf.nn.relu(inception_3a_3x3_reduce, name = 'inception_3a/relu_3x3_reduce')
    inception_3a_relu_pool_proj = tf.nn.relu(inception_3a_pool_proj, name = 'inception_3a/relu_pool_proj')
    inception_3a_double_3x3_1_pad = tf.pad(inception_3a_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3a_double_3x3_1 = convolution(inception_3a_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_3a/double_3x3_1')
    inception_3a_3x3_pad = tf.pad(inception_3a_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3a_3x3 = convolution(inception_3a_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_3a/3x3')
    inception_3a_relu_double_3x3_1 = tf.nn.relu(inception_3a_double_3x3_1, name = 'inception_3a/relu_double_3x3_1')
    inception_3a_relu_3x3 = tf.nn.relu(inception_3a_3x3, name = 'inception_3a/relu_3x3')
    inception_3a_double_3x3_2_pad = tf.pad(inception_3a_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3a_double_3x3_2 = convolution(inception_3a_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_3a/double_3x3_2')
    inception_3a_relu_double_3x3_2 = tf.nn.relu(inception_3a_double_3x3_2, name = 'inception_3a/relu_double_3x3_2')
    inception_3a_output = tf.concat([inception_3a_relu_1x1, inception_3a_relu_3x3, inception_3a_relu_double_3x3_2, inception_3a_relu_pool_proj], 3, name = 'inception_3a/output')
    inception_3b_3x3_reduce = convolution(inception_3a_output, group=1, strides=[1, 1], padding='VALID', name='inception_3b/3x3_reduce')
    inception_3b_pool = tf.nn.avg_pool(inception_3a_output, [1, 3, 3, 1], [1, 1, 1, 1], padding='SAME', name='inception_3b/pool')
    inception_3b_double_3x3_reduce = convolution(inception_3a_output, group=1, strides=[1, 1], padding='VALID', name='inception_3b/double_3x3_reduce')
    inception_3b_1x1 = convolution(inception_3a_output, group=1, strides=[1, 1], padding='VALID', name='inception_3b/1x1')
    inception_3b_relu_3x3_reduce = tf.nn.relu(inception_3b_3x3_reduce, name = 'inception_3b/relu_3x3_reduce')
    inception_3b_pool_proj = convolution(inception_3b_pool, group=1, strides=[1, 1], padding='VALID', name='inception_3b/pool_proj')
    inception_3b_relu_double_3x3_reduce = tf.nn.relu(inception_3b_double_3x3_reduce, name = 'inception_3b/relu_double_3x3_reduce')
    inception_3b_relu_1x1 = tf.nn.relu(inception_3b_1x1, name = 'inception_3b/relu_1x1')
    inception_3b_3x3_pad = tf.pad(inception_3b_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3b_3x3 = convolution(inception_3b_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_3b/3x3')
    inception_3b_relu_pool_proj = tf.nn.relu(inception_3b_pool_proj, name = 'inception_3b/relu_pool_proj')
    inception_3b_double_3x3_1_pad = tf.pad(inception_3b_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3b_double_3x3_1 = convolution(inception_3b_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_3b/double_3x3_1')
    inception_3b_relu_3x3 = tf.nn.relu(inception_3b_3x3, name = 'inception_3b/relu_3x3')
    inception_3b_relu_double_3x3_1 = tf.nn.relu(inception_3b_double_3x3_1, name = 'inception_3b/relu_double_3x3_1')
    inception_3b_double_3x3_2_pad = tf.pad(inception_3b_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3b_double_3x3_2 = convolution(inception_3b_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_3b/double_3x3_2')
    inception_3b_relu_double_3x3_2 = tf.nn.relu(inception_3b_double_3x3_2, name = 'inception_3b/relu_double_3x3_2')
    inception_3b_output = tf.concat([inception_3b_relu_1x1, inception_3b_relu_3x3, inception_3b_relu_double_3x3_2, inception_3b_relu_pool_proj], 3, name = 'inception_3b/output')
    inception_3c_pool_pad = tf.pad(inception_3b_output, paddings = [[0, 0], [0, 1], [0, 1], [0, 0]], constant_values=float('-Inf'))
    inception_3c_pool = tf.nn.max_pool(inception_3c_pool_pad, [1, 3, 3, 1], [1, 2, 2, 1], padding='VALID', name='inception_3c/pool')
    inception_3c_3x3_reduce = convolution(inception_3b_output, group=1, strides=[1, 1], padding='VALID', name='inception_3c/3x3_reduce')
    inception_3c_double_3x3_reduce = convolution(inception_3b_output, group=1, strides=[1, 1], padding='VALID', name='inception_3c/double_3x3_reduce')
    inception_3c_relu_3x3_reduce = tf.nn.relu(inception_3c_3x3_reduce, name = 'inception_3c/relu_3x3_reduce')
    inception_3c_relu_double_3x3_reduce = tf.nn.relu(inception_3c_double_3x3_reduce, name = 'inception_3c/relu_double_3x3_reduce')
    inception_3c_3x3_pad = tf.pad(inception_3c_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3c_3x3 = convolution(inception_3c_3x3_pad, group=1, strides=[2, 2], padding='VALID', name='inception_3c/3x3')
    inception_3c_double_3x3_1_pad = tf.pad(inception_3c_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3c_double_3x3_1 = convolution(inception_3c_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_3c/double_3x3_1')
    inception_3c_relu_3x3 = tf.nn.relu(inception_3c_3x3, name = 'inception_3c/relu_3x3')
    inception_3c_relu_double_3x3_1 = tf.nn.relu(inception_3c_double_3x3_1, name = 'inception_3c/relu_double_3x3_1')
    inception_3c_double_3x3_2_pad = tf.pad(inception_3c_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_3c_double_3x3_2 = convolution(inception_3c_double_3x3_2_pad, group=1, strides=[2, 2], padding='VALID', name='inception_3c/double_3x3_2')
    inception_3c_relu_double_3x3_2 = tf.nn.relu(inception_3c_double_3x3_2, name = 'inception_3c/relu_double_3x3_2')
    inception_3c_output = tf.concat([inception_3c_relu_3x3, inception_3c_relu_double_3x3_2, inception_3c_pool], 3, name = 'inception_3c/output')
    inception_4a_3x3_reduce = convolution(inception_3c_output, group=1, strides=[1, 1], padding='VALID', name='inception_4a/3x3_reduce')
    inception_4a_1x1 = convolution(inception_3c_output, group=1, strides=[1, 1], padding='VALID', name='inception_4a/1x1')
    inception_4a_double_3x3_reduce = convolution(inception_3c_output, group=1, strides=[1, 1], padding='VALID', name='inception_4a/double_3x3_reduce')
    inception_4a_pool = tf.nn.avg_pool(inception_3c_output, [1, 3, 3, 1], [1, 1, 1, 1], padding='SAME', name='inception_4a/pool')
    inception_4a_relu_3x3_reduce = tf.nn.relu(inception_4a_3x3_reduce, name = 'inception_4a/relu_3x3_reduce')
    inception_4a_relu_1x1 = tf.nn.relu(inception_4a_1x1, name = 'inception_4a/relu_1x1')
    inception_4a_relu_double_3x3_reduce = tf.nn.relu(inception_4a_double_3x3_reduce, name = 'inception_4a/relu_double_3x3_reduce')
    inception_4a_pool_proj = convolution(inception_4a_pool, group=1, strides=[1, 1], padding='VALID', name='inception_4a/pool_proj')
    inception_4a_3x3_pad = tf.pad(inception_4a_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4a_3x3 = convolution(inception_4a_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4a/3x3')
    inception_4a_double_3x3_1_pad = tf.pad(inception_4a_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4a_double_3x3_1 = convolution(inception_4a_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4a/double_3x3_1')
    inception_4a_relu_pool_proj = tf.nn.relu(inception_4a_pool_proj, name = 'inception_4a/relu_pool_proj')
    inception_4a_relu_3x3 = tf.nn.relu(inception_4a_3x3, name = 'inception_4a/relu_3x3')
    inception_4a_relu_double_3x3_1 = tf.nn.relu(inception_4a_double_3x3_1, name = 'inception_4a/relu_double_3x3_1')
    inception_4a_double_3x3_2_pad = tf.pad(inception_4a_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4a_double_3x3_2 = convolution(inception_4a_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4a/double_3x3_2')
    inception_4a_relu_double_3x3_2 = tf.nn.relu(inception_4a_double_3x3_2, name = 'inception_4a/relu_double_3x3_2')
    inception_4a_output = tf.concat([inception_4a_relu_1x1, inception_4a_relu_3x3, inception_4a_relu_double_3x3_2, inception_4a_relu_pool_proj], 3, name = 'inception_4a/output')
    inception_4b_pool = tf.nn.avg_pool(inception_4a_output, [1, 3, 3, 1], [1, 1, 1, 1], padding='SAME', name='inception_4b/pool')
    inception_4b_1x1 = convolution(inception_4a_output, group=1, strides=[1, 1], padding='VALID', name='inception_4b/1x1')
    inception_4b_double_3x3_reduce = convolution(inception_4a_output, group=1, strides=[1, 1], padding='VALID', name='inception_4b/double_3x3_reduce')
    inception_4b_3x3_reduce = convolution(inception_4a_output, group=1, strides=[1, 1], padding='VALID', name='inception_4b/3x3_reduce')
    inception_4b_pool_proj = convolution(inception_4b_pool, group=1, strides=[1, 1], padding='VALID', name='inception_4b/pool_proj')
    inception_4b_relu_1x1 = tf.nn.relu(inception_4b_1x1, name = 'inception_4b/relu_1x1')
    inception_4b_relu_double_3x3_reduce = tf.nn.relu(inception_4b_double_3x3_reduce, name = 'inception_4b/relu_double_3x3_reduce')
    inception_4b_relu_3x3_reduce = tf.nn.relu(inception_4b_3x3_reduce, name = 'inception_4b/relu_3x3_reduce')
    inception_4b_relu_pool_proj = tf.nn.relu(inception_4b_pool_proj, name = 'inception_4b/relu_pool_proj')
    inception_4b_double_3x3_1_pad = tf.pad(inception_4b_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4b_double_3x3_1 = convolution(inception_4b_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4b/double_3x3_1')
    inception_4b_3x3_pad = tf.pad(inception_4b_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4b_3x3 = convolution(inception_4b_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4b/3x3')
    inception_4b_relu_double_3x3_1 = tf.nn.relu(inception_4b_double_3x3_1, name = 'inception_4b/relu_double_3x3_1')
    inception_4b_relu_3x3 = tf.nn.relu(inception_4b_3x3, name = 'inception_4b/relu_3x3')
    inception_4b_double_3x3_2_pad = tf.pad(inception_4b_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4b_double_3x3_2 = convolution(inception_4b_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4b/double_3x3_2')
    inception_4b_relu_double_3x3_2 = tf.nn.relu(inception_4b_double_3x3_2, name = 'inception_4b/relu_double_3x3_2')
    inception_4b_output = tf.concat([inception_4b_relu_1x1, inception_4b_relu_3x3, inception_4b_relu_double_3x3_2, inception_4b_relu_pool_proj], 3, name = 'inception_4b/output')
    inception_4c_pool = tf.nn.avg_pool(inception_4b_output, [1, 3, 3, 1], [1, 1, 1, 1], padding='SAME', name='inception_4c/pool')
    inception_4c_double_3x3_reduce = convolution(inception_4b_output, group=1, strides=[1, 1], padding='VALID', name='inception_4c/double_3x3_reduce')
    inception_4c_1x1 = convolution(inception_4b_output, group=1, strides=[1, 1], padding='VALID', name='inception_4c/1x1')
    inception_4c_3x3_reduce = convolution(inception_4b_output, group=1, strides=[1, 1], padding='VALID', name='inception_4c/3x3_reduce')
    inception_4c_pool_proj = convolution(inception_4c_pool, group=1, strides=[1, 1], padding='VALID', name='inception_4c/pool_proj')
    inception_4c_relu_double_3x3_reduce = tf.nn.relu(inception_4c_double_3x3_reduce, name = 'inception_4c/relu_double_3x3_reduce')
    inception_4c_relu_1x1 = tf.nn.relu(inception_4c_1x1, name = 'inception_4c/relu_1x1')
    inception_4c_relu_3x3_reduce = tf.nn.relu(inception_4c_3x3_reduce, name = 'inception_4c/relu_3x3_reduce')
    inception_4c_relu_pool_proj = tf.nn.relu(inception_4c_pool_proj, name = 'inception_4c/relu_pool_proj')
    inception_4c_double_3x3_1_pad = tf.pad(inception_4c_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4c_double_3x3_1 = convolution(inception_4c_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4c/double_3x3_1')
    inception_4c_3x3_pad = tf.pad(inception_4c_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4c_3x3 = convolution(inception_4c_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4c/3x3')
    inception_4c_relu_double_3x3_1 = tf.nn.relu(inception_4c_double_3x3_1, name = 'inception_4c/relu_double_3x3_1')
    inception_4c_relu_3x3 = tf.nn.relu(inception_4c_3x3, name = 'inception_4c/relu_3x3')
    inception_4c_double_3x3_2_pad = tf.pad(inception_4c_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4c_double_3x3_2 = convolution(inception_4c_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4c/double_3x3_2')
    inception_4c_relu_double_3x3_2 = tf.nn.relu(inception_4c_double_3x3_2, name = 'inception_4c/relu_double_3x3_2')
    inception_4c_output = tf.concat([inception_4c_relu_1x1, inception_4c_relu_3x3, inception_4c_relu_double_3x3_2, inception_4c_relu_pool_proj], 3, name = 'inception_4c/output')
    inception_4d_pool = tf.nn.avg_pool(inception_4c_output, [1, 3, 3, 1], [1, 1, 1, 1], padding='SAME', name='inception_4d/pool')
    inception_4d_double_3x3_reduce = convolution(inception_4c_output, group=1, strides=[1, 1], padding='VALID', name='inception_4d/double_3x3_reduce')
    inception_4d_3x3_reduce = convolution(inception_4c_output, group=1, strides=[1, 1], padding='VALID', name='inception_4d/3x3_reduce')
    inception_4d_1x1 = convolution(inception_4c_output, group=1, strides=[1, 1], padding='VALID', name='inception_4d/1x1')
    inception_4d_pool_proj = convolution(inception_4d_pool, group=1, strides=[1, 1], padding='VALID', name='inception_4d/pool_proj')
    inception_4d_relu_double_3x3_reduce = tf.nn.relu(inception_4d_double_3x3_reduce, name = 'inception_4d/relu_double_3x3_reduce')
    inception_4d_relu_3x3_reduce = tf.nn.relu(inception_4d_3x3_reduce, name = 'inception_4d/relu_3x3_reduce')
    inception_4d_relu_1x1 = tf.nn.relu(inception_4d_1x1, name = 'inception_4d/relu_1x1')
    inception_4d_relu_pool_proj = tf.nn.relu(inception_4d_pool_proj, name = 'inception_4d/relu_pool_proj')
    inception_4d_double_3x3_1_pad = tf.pad(inception_4d_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4d_double_3x3_1 = convolution(inception_4d_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4d/double_3x3_1')
    inception_4d_3x3_pad = tf.pad(inception_4d_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4d_3x3 = convolution(inception_4d_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4d/3x3')
    inception_4d_relu_double_3x3_1 = tf.nn.relu(inception_4d_double_3x3_1, name = 'inception_4d/relu_double_3x3_1')
    inception_4d_relu_3x3 = tf.nn.relu(inception_4d_3x3, name = 'inception_4d/relu_3x3')
    inception_4d_double_3x3_2_pad = tf.pad(inception_4d_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4d_double_3x3_2 = convolution(inception_4d_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4d/double_3x3_2')
    inception_4d_relu_double_3x3_2 = tf.nn.relu(inception_4d_double_3x3_2, name = 'inception_4d/relu_double_3x3_2')
    inception_4d_output = tf.concat([inception_4d_relu_1x1, inception_4d_relu_3x3, inception_4d_relu_double_3x3_2, inception_4d_relu_pool_proj], 3, name = 'inception_4d/output')
    inception_4e_double_3x3_reduce = convolution(inception_4d_output, group=1, strides=[1, 1], padding='VALID', name='inception_4e/double_3x3_reduce')
    inception_4e_3x3_reduce = convolution(inception_4d_output, group=1, strides=[1, 1], padding='VALID', name='inception_4e/3x3_reduce')
    inception_4e_pool_pad = tf.pad(inception_4d_output, paddings = [[0, 0], [0, 1], [0, 1], [0, 0]], constant_values=float('-Inf'))
    inception_4e_pool = tf.nn.max_pool(inception_4e_pool_pad, [1, 3, 3, 1], [1, 2, 2, 1], padding='VALID', name='inception_4e/pool')
    inception_4e_relu_double_3x3_reduce = tf.nn.relu(inception_4e_double_3x3_reduce, name = 'inception_4e/relu_double_3x3_reduce')
    inception_4e_relu_3x3_reduce = tf.nn.relu(inception_4e_3x3_reduce, name = 'inception_4e/relu_3x3_reduce')
    inception_4e_double_3x3_1_pad = tf.pad(inception_4e_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4e_double_3x3_1 = convolution(inception_4e_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_4e/double_3x3_1')
    inception_4e_3x3_pad = tf.pad(inception_4e_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4e_3x3 = convolution(inception_4e_3x3_pad, group=1, strides=[2, 2], padding='VALID', name='inception_4e/3x3')
    inception_4e_relu_double_3x3_1 = tf.nn.relu(inception_4e_double_3x3_1, name = 'inception_4e/relu_double_3x3_1')
    inception_4e_relu_3x3 = tf.nn.relu(inception_4e_3x3, name = 'inception_4e/relu_3x3')
    inception_4e_double_3x3_2_pad = tf.pad(inception_4e_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_4e_double_3x3_2 = convolution(inception_4e_double_3x3_2_pad, group=1, strides=[2, 2], padding='VALID', name='inception_4e/double_3x3_2')
    inception_4e_relu_double_3x3_2 = tf.nn.relu(inception_4e_double_3x3_2, name = 'inception_4e/relu_double_3x3_2')
    inception_4e_output = tf.concat([inception_4e_relu_3x3, inception_4e_relu_double_3x3_2, inception_4e_pool], 3, name = 'inception_4e/output')
    inception_5a_1x1 = convolution(inception_4e_output, group=1, strides=[1, 1], padding='VALID', name='inception_5a/1x1')
    inception_5a_pool = tf.nn.avg_pool(inception_4e_output, [1, 3, 3, 1], [1, 1, 1, 1], padding='SAME', name='inception_5a/pool')
    inception_5a_double_3x3_reduce = convolution(inception_4e_output, group=1, strides=[1, 1], padding='VALID', name='inception_5a/double_3x3_reduce')
    inception_5a_3x3_reduce = convolution(inception_4e_output, group=1, strides=[1, 1], padding='VALID', name='inception_5a/3x3_reduce')
    inception_5a_relu_1x1 = tf.nn.relu(inception_5a_1x1, name = 'inception_5a/relu_1x1')
    inception_5a_pool_proj = convolution(inception_5a_pool, group=1, strides=[1, 1], padding='VALID', name='inception_5a/pool_proj')
    inception_5a_relu_double_3x3_reduce = tf.nn.relu(inception_5a_double_3x3_reduce, name = 'inception_5a/relu_double_3x3_reduce')
    inception_5a_relu_3x3_reduce = tf.nn.relu(inception_5a_3x3_reduce, name = 'inception_5a/relu_3x3_reduce')
    inception_5a_relu_pool_proj = tf.nn.relu(inception_5a_pool_proj, name = 'inception_5a/relu_pool_proj')
    inception_5a_double_3x3_1_pad = tf.pad(inception_5a_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_5a_double_3x3_1 = convolution(inception_5a_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_5a/double_3x3_1')
    inception_5a_3x3_pad = tf.pad(inception_5a_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_5a_3x3 = convolution(inception_5a_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_5a/3x3')
    inception_5a_relu_double_3x3_1 = tf.nn.relu(inception_5a_double_3x3_1, name = 'inception_5a/relu_double_3x3_1')
    inception_5a_relu_3x3 = tf.nn.relu(inception_5a_3x3, name = 'inception_5a/relu_3x3')
    inception_5a_double_3x3_2_pad = tf.pad(inception_5a_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_5a_double_3x3_2 = convolution(inception_5a_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_5a/double_3x3_2')
    inception_5a_relu_double_3x3_2 = tf.nn.relu(inception_5a_double_3x3_2, name = 'inception_5a/relu_double_3x3_2')
    inception_5a_output = tf.concat([inception_5a_relu_1x1, inception_5a_relu_3x3, inception_5a_relu_double_3x3_2, inception_5a_relu_pool_proj], 3, name = 'inception_5a/output')
    inception_5b_pool_pad = tf.pad(inception_5a_output, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]], constant_values=float('-Inf'))
    inception_5b_pool = tf.nn.max_pool(inception_5b_pool_pad, [1, 3, 3, 1], [1, 1, 1, 1], padding='VALID', name='inception_5b/pool')
    inception_5b_3x3_reduce = convolution(inception_5a_output, group=1, strides=[1, 1], padding='VALID', name='inception_5b/3x3_reduce')
    inception_5b_1x1 = convolution(inception_5a_output, group=1, strides=[1, 1], padding='VALID', name='inception_5b/1x1')
    inception_5b_double_3x3_reduce = convolution(inception_5a_output, group=1, strides=[1, 1], padding='VALID', name='inception_5b/double_3x3_reduce')
    inception_5b_pool_proj = convolution(inception_5b_pool, group=1, strides=[1, 1], padding='VALID', name='inception_5b/pool_proj')
    inception_5b_relu_3x3_reduce = tf.nn.relu(inception_5b_3x3_reduce, name = 'inception_5b/relu_3x3_reduce')
    inception_5b_relu_1x1 = tf.nn.relu(inception_5b_1x1, name = 'inception_5b/relu_1x1')
    inception_5b_relu_double_3x3_reduce = tf.nn.relu(inception_5b_double_3x3_reduce, name = 'inception_5b/relu_double_3x3_reduce')
    inception_5b_relu_pool_proj = tf.nn.relu(inception_5b_pool_proj, name = 'inception_5b/relu_pool_proj')
    inception_5b_3x3_pad = tf.pad(inception_5b_relu_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_5b_3x3 = convolution(inception_5b_3x3_pad, group=1, strides=[1, 1], padding='VALID', name='inception_5b/3x3')
    inception_5b_double_3x3_1_pad = tf.pad(inception_5b_relu_double_3x3_reduce, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_5b_double_3x3_1 = convolution(inception_5b_double_3x3_1_pad, group=1, strides=[1, 1], padding='VALID', name='inception_5b/double_3x3_1')
    inception_5b_relu_3x3 = tf.nn.relu(inception_5b_3x3, name = 'inception_5b/relu_3x3')
    inception_5b_relu_double_3x3_1 = tf.nn.relu(inception_5b_double_3x3_1, name = 'inception_5b/relu_double_3x3_1')
    inception_5b_double_3x3_2_pad = tf.pad(inception_5b_relu_double_3x3_1, paddings = [[0, 0], [1, 1], [1, 1], [0, 0]])
    inception_5b_double_3x3_2 = convolution(inception_5b_double_3x3_2_pad, group=1, strides=[1, 1], padding='VALID', name='inception_5b/double_3x3_2')
    inception_5b_relu_double_3x3_2 = tf.nn.relu(inception_5b_double_3x3_2, name = 'inception_5b/relu_double_3x3_2')
    inception_5b_output = tf.concat([inception_5b_relu_1x1, inception_5b_relu_3x3, inception_5b_relu_double_3x3_2, inception_5b_relu_pool_proj], 3, name = 'inception_5b/output')
    global_pool     = tf.nn.avg_pool(inception_5b_output, [1, 7, 7, 1], [1, 1, 1, 1], padding='VALID', name='global_pool')
    fc_0            = tf.contrib.layers.flatten(global_pool)
    fc_1            = tf.layers.dense(fc_0, 365, kernel_initializer = tf.constant_initializer(__weights_dict['fc_1']['weights']), bias_initializer = tf.constant_initializer(__weights_dict['fc_1']['bias']), use_bias = True)
    return input, fc_1


def convolution(input, name, group, **kwargs):
    w = tf.Variable( trainable=is_train, name=name + "_weight")
    if group == 1:
        layer = tf.nn.convolution(input, w, name=name, **kwargs)
    else:
        weight_groups = tf.split(w, num_or_size_splits=group, axis=-1)
        xs = tf.split(input, num_or_size_splits=group, axis=-1)
        convolved = [tf.nn.convolution(x, weight, name=name, **kwargs) for
                    (x, weight) in zip(xs, weight_groups)]
        layer = tf.concat(convolved, axis=-1)

    b = tf.Variable(trainable=is_train, name=name + "_bias")
    layer = layer + b
    return layer
